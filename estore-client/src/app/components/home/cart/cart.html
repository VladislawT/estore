<ng-container>
  @if (!cartStore.cart().products.length) {
    <div
      class="w-[90%] h-[20em] flex flex-col items-center justify-center mx-auto mt-12 p-6 bg-gray-50 rounded-xl shadow-md"
    >
      <div class="flex flex-col items-center text-grey-500">
        <fa-icon [icon]="faBoxOpen" class="text-[70px] mb-4"> </fa-icon>
        <p class="text-[28px] font-semibold">Ваша корзина пуста</p>
        <p class="text-sm text-green-500 mt-2"></p>
      </div>
      <div class="w-full border-t border-gray-500 my-6"></div>
      <button
        type="button"
        class="flex items-center gap-2 bg-amber-400 hover:bg-amber-500 text-black font-semibold px-6 py-2 rounded-full transition-all duration-300 shadow-sm cursor-pointer"
        (click)="navigateToHome()"
      >
        <fa-icon [icon]="faShoppingCart" class="text-lg"></fa-icon>
        Продолжить покупки
      </button>
    </div>

    @if (alertMessage !== '') {
      <div
        [ngClass]="{
          'bg-green-500': alertType === 0,
          'bg-red-500': alertType !== 0,
        }"
      >
        {{ alertMessage }}
      </div>
    }
  } @else if (cartStore.cart()) {
    <div class="flex w-[90%] h-[20em] w-full">
      <div class="w-[70%] text-center mx-auto my-12">
        @for (cartItem of cartStore.cart().products; track $index) {
          <div class="flex flex-wrap md:flex-nowrap mb-8 shadow-md p-4 rounded-lg bg-white">
            <div class="w-full md:1/3 flex justify-center mb-4 md:mb-0">
              <img
                [src]="'assets/images/' + cartItem.product.product_img"
                alt="product img"
                class="h-[13em] rounded-md object-cover"
                srcset=""
              />
              <div class="w-full md:w-2/3 flex-col justify-between text-left p-3">
                <div class="flex justify-between items-start">
                  <span class="text-xl font-semibold">{{ cartItem.product.product_name }}</span>
                  <span class="text-2xl font-bold">{{ cartItem.product.price | currency }}</span>
                </div>

                <div class="my-2">
                  <app-ratings [score]="cartItem.product.ratings"></app-ratings>
                </div>
                <hr class="my-3 border-gray-300" />
                <div class="flex items-center flex-wrap gap-4">
                  <div
                    class="flex border rounded overflow-hidden"
                    (click)="updateQuantity($event, cartItem)"
                  >
                    <button
                      class="px-3 py-1 bg-gray-200 hover:bg-gray-300 font-bold cursor-pointer"
                    >
                      -
                    </button>
                  </div>
                  <div class="px-4 py-1 font-semibold text-center min-w-[3rem]">
                    {{ cartItem.quantity }}
                  </div>
                  <button
                    class="px-3 py-1 bg-gray-200 hover:bg-gray-300 font-bold cursor-pointer"
                    (click)="updateQuantity($event, cartItem)"
                  >
                    +
                  </button>
                  <button
                    type="button"
                    class="bg-red-500 hover:bg-red-600 text-white font-semibold px-4 py-2 rounded cursor-pointer flex items-center gap-2"
                    (click)="removeItem(cartItem)"
                  >
                    <fa-icon [icon]="faTrash"></fa-icon>
                    Remove Item
                  </button>
                </div>
              </div>
            </div>
          </div>
        }
      </div>
      <!--Cart Summary-->
      <div class="w-full lg:w-[30%] h-fit bg-grey-500 p-6 rounded-lg shadow-md">
        @if (alertMessage !== '') {
          <div
            [ngClass]="{
              'bg-green-500': alertType === 0,
              'bg-red-500': alertType !== 0,
            }"
          >
            {{ alertMessage }}
          </div>
        }
        <form [formGroup]="orderForm()" (ngSubmit)="onSubmit()">
          <h2 class="text-2xl font-bold mb-4">Delivery Address</h2>
          <div class="space-y-4">
            <div class="flex flex-col">
              <label for="name" class="text-gray-600">Name</label>
              <input
                type="text"
                id="name"
                formControlName="name"
                class="px-4 py-2 border rounded-md"
              />
            </div>
            <div class="flex flex-col">
              <label for="address" class="text-gray-600">Address</label>
              <input
                type="text"
                id="address"
                formControlName="address"
                class="px-4 py-2 border rounded-md"
              />
            </div>
            <div class="flex flex-col">
              <label for="city" class="text-gray-600">city</label>
              <input
                type="text"
                id="city"
                formControlName="city"
                class="px-4 py-2 border rounded-md"
              />
            </div>
            <div class="flex flex-col">
              <label for="state" class="text-gray-600">city</label>
              <input
                type="text"
                id="state"
                formControlName="state"
                class="px-4 py-2 border rounded-md"
              />
            </div>
            <div class="flex flex-col">
              <label for="pin" class="text-gray-600">city</label>
              <input
                type="text"
                id="pin"
                formControlName="pin"
                class="px-4 py-2 border rounded-md"
              />
            </div>
          </div>
          <h2 class="text-2xl font-bold mb-4">Summary</h2>
          <div class="text-left space-y-2">
            <p class="text-gray-600">Cart Total: {{ cartStore.cart().totalAmount | currency }}</p>
            <p class="text-gray-600">Shipping Carges: <span>Free</span></p>
            <hr />
            <p class="text-xl font-bold">Total: {{ cartStore.cart().totalAmount | currency }}</p>
          </div>
          <button
            type="submit"
            [disabled]="!orderForm().valid || disableChekout"
            class="w-full mt-5 bg-green-800 text-white py-2 rounded hover:bg-grey-900 transition cursor-pointer disabled:bg-gray-400 disabled:cursor-not-allowed"
          >
            Checkout
          </button>
        </form>
      </div>
    </div>
  }
</ng-container>
